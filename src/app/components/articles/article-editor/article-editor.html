<div class="bg-gray-50">
  <!-- Header -->
  <div class="px-6 py-4">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-4">
        <button (click)="onGoBack()" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
          <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
        </button>
        <div>
          <h1 class="text-2xl font-bold text-gray-900">New Article</h1>
          <p class="text-gray-600 text-sm">Create engaging content for your audience</p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex items-center gap-3">
        <button (click)="togglePreview()"
          class="px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z">
            </path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z">
            </path>
          </svg>
          {{ isPreviewMode ? 'Edit' : 'Preview' }}
        </button>

        <button (click)="saveDraft()" [disabled]="isSubmitting"
          class="px-4 py-2 text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
          {{ isSubmitting ? 'Saving...' : 'Save Draft' }}
        </button>

        <button (click)="submit()" [disabled]="isSubmitting"
          class="px-4 py-2 bg-gray-900 text-white hover:bg-gray-800 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
          <svg *ngIf="!isSubmitting" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8">
            </path>
          </svg>
          <svg *ngIf="isSubmitting" class="animate-spin w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
            </path>
          </svg>
          {{ isSubmitting ? 'Submitting...' : 'Submit' }}
        </button>
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="submitError"
      class="mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2">
      <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      {{ submitError }}
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex gap-6 p-6 pt-2">
    <!-- Left Column - Article Content -->
    <div class="flex-1">
      <div class="bg-white rounded-lg shadow-sm p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-6">Article Content</h2>

        <!-- Title -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Title *
            <span class="text-xs text-gray-500 ml-2">({{ titleCharCount }}/100)</span>
          </label>
          <input type="text" [(ngModel)]="article.title" (input)="onTitleChange()" placeholder="Enter article title..."
            maxlength="100" required
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
        </div>

        <!-- URL Slug -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-2">URL Slug</label>
          <input type="text" [(ngModel)]="article.urlSlug" placeholder="article-url-slug"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-blue-600">
        </div>

        <!-- Excerpt -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Excerpt *
            <span class="text-xs text-gray-500 ml-2">({{ excerptCharCount }}/200)</span>
          </label>
          <textarea [(ngModel)]="article.excerpt" placeholder="Brief description of the article..." maxlength="200"
            rows="3" required
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none"></textarea>
        </div>

        <!-- Content Editor -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-2">Content *</label>
          <textarea [(ngModel)]="article.content" placeholder="Write your article content here..." rows="12" required
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-y"></textarea>
        </div>
      </div>
    </div>

    <!-- Right Column - Settings & Details -->
    <div class="w-80 space-y-6">
      <!-- Submit Settings -->
      <div class="bg-white rounded-lg shadow-sm p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">Submit Settings</h3>

        <!-- Status -->
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
          <select [(ngModel)]="article.status"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
            <option *ngFor="let status of statusOptions" [value]="status.value">
              {{ status.label }}
            </option>
          </select>
        </div>

        <!-- Featured Article -->
        <div class="flex items-center justify-between mb-4">
          <label class="text-sm font-medium text-gray-700">Featured Article</label>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" [(ngModel)]="article.featuredArticle" class="sr-only peer">
            <div
              class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
            </div>
          </label>
        </div>

        <!-- Trending Article -->
        <div class="flex items-center justify-between">
          <label class="text-sm font-medium text-gray-700">Trending Article</label>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" [(ngModel)]="article.trending" class="sr-only peer">
            <div
              class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
            </div>
          </label>
        </div>
      </div>

      <!-- Article Details -->
      <div class="bg-white rounded-lg shadow-sm p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">Article Details</h3>

        <!-- Categories - Checkbox list -->
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-2">Categories *</label>
          
          <!-- Checkbox list -->
          <div class="max-h-40 overflow-y-auto border border-gray-300 rounded-lg p-3 bg-gray-50">
            <div *ngFor="let category of categoryOptions" class="flex items-center mb-3 last:mb-0">
              <input type="checkbox" 
                     [id]="'category-' + category.id" 
                     [checked]="isCategorySelected(category.id)"
                     (change)="toggleCategorySelection(category.id)"
                     class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2">
              <label [for]="'category-' + category.id" 
                     class="ml-3 text-sm font-medium text-gray-700 cursor-pointer hover:text-gray-900 flex-1">
                {{ category.name }}
              </label>
            </div>
            <div *ngIf="categoryOptions.length === 0" class="text-sm text-gray-500 text-center py-2">
              No categories available
            </div>
          </div>
          
          <!-- Selected categories count -->
          <p class="text-xs text-gray-500 mt-2">
            {{ article.selectedCategoryIds.length }} 
            {{ article.selectedCategoryIds.length === 1 ? 'category' : 'categories' }} selected
          </p>
          
          <!-- Selected categories display -->
          <div *ngIf="article.selectedCategoryIds.length > 0" class="mt-3">
            <div class="flex flex-wrap gap-2">
              <span *ngFor="let categoryId of article.selectedCategoryIds" 
                    class="inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium">
                {{ getCategoryNameById(categoryId) }}
                <button (click)="toggleCategorySelection(categoryId)" 
                        class="hover:text-blue-600 ml-1 hover:bg-blue-200 rounded-full p-0.5"
                        type="button">
                  <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                      d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                      clip-rule="evenodd"></path>
                  </svg>
                </button>
              </span>
            </div>
          </div>
        </div>

        <!-- Featured Image -->
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-2">Featured Image URL</label>
          <div class="space-y-3">
            <input type="text" [(ngModel)]="article.featuredImageUrl" placeholder="https://example.com/image.jpg"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-sm">

            <div class="text-center">
              <span class="text-xs text-gray-500">or</span>
            </div>

            <label class="block">
              <input type="file" accept="image/*" (change)="onImageUpload($event)" class="hidden">
              <div
                class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 cursor-pointer">
                <svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                </svg>
                <p class="text-sm text-gray-500 mt-2">Upload Image</p>
              </div>
            </label>

            <!-- Image Preview -->
            <div *ngIf="article.featuredImageUrl" class="mt-3">
              <img [src]="article.featuredImageUrl" alt="Featured image preview"
                class="w-full h-32 object-cover rounded-lg">
            </div>
          </div>
        </div>

        <!-- Tags -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
          <div class="flex gap-2 mb-3">
            <input #tagInput type="text" [(ngModel)]="newTag" (keypress)="onTagKeyPress($event)" placeholder="Add tag"
              class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-sm">
            <button (click)="addTag()"
              class="px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm">
              Add
            </button>
          </div>

          <!-- Tag List -->
          <div class="flex flex-wrap gap-2">
            <span *ngFor="let tag of article.tags; let i = index"
              class="inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">
              {{ tag }}
              <button (click)="removeTag(i)" class="hover:text-blue-600">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd"
                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                    clip-rule="evenodd"></path>
                </svg>
              </button>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>